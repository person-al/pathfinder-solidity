## TODOs

- [x] determine token metadata and SVG rendering
- [ ] finish all unit tests
- [x] create script to generate all potential image outcomes
- [ ] ~~see where we can save on gas~~ (I may be leaning more heavily towards features now :/)
- [ ] ~~make royalties OpenSea compatible~~ I decided on no royalties for this project
- [ ] ~~support contract-level metadata for OpenSea: https://docs.opensea.io/docs/contract-level-metadata~~ I'll just do it manually. If OpenSea isn't going to support the standard royalty format, why should I bother putting their desired metadata format onchain
- [x] deploy on testnet
- [x] remove tip functionality
- [ ] ~~make licensing clear~~ (no need, I think)
- [x] improve README
- [x] create website homepage (optional)
- [x] come up with a better project name
- [x] update repo name
- [ ] deploy on mainnet

## Potential modifications:

- [x] Add distortion to SVG based on jitter and opacity like so: https://tympanus.net/codrops/2019/02/19/svg-filter-effects-creating-texture-with-feturbulence/

## 2023-03-02

### Minor changes

- minor property-packing changes

### Gas usage

```
·---------------------------------------|---------------------------|-------------|-----------------------------·
|         Solc version: 0.8.15          ·  Optimizer enabled: true  ·  Runs: 800  ·  Block limit: 30000000 gas  │
········································|···························|·············|······························
|  Methods                              ·               34 gwei/gas               ·       1658.30 usd/eth       │
·················|······················|·············|·············|·············|···············|··············
|  Contract      ·  Method              ·  Min        ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  burn                ·      62457  ·      99938  ·      70474  ·           70  ·       3.97  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  mint                ·      64692  ·      98892  ·      81060  ·           70  ·       4.57  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  transferFrom        ·      45864  ·      67778  ·      60442  ·          106  ·       3.41  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  burn                ·      65584  ·      99757  ·      78343  ·           33  ·       4.42  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  mint                ·      64749  ·      98949  ·      88515  ·           59  ·       4.99  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  packNode            ·      38846  ·      38906  ·      38883  ·           19  ·       2.19  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  setHistoricalInput  ·      29064  ·      29076  ·      29071  ·           23  ·       1.64  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  transferFrom        ·      50720  ·      67822  ·      55436  ·           58  ·       3.13  │
·················|······················|·············|·············|·············|···············|··············
|  Deployments                          ·                                         ·  % of limit   ·             │
········································|·············|·············|·············|···············|··············
|  Poem                                 ·          -  ·          -  ·    4465840  ·       14.9 %  ·     251.79  │
········································|·············|·············|·············|···············|··············
|  TestablePoem                         ·          -  ·          -  ·    5826102  ·       19.4 %  ·     328.49  │
·---------------------------------------|-------------|-------------|-------------|---------------|-------------·

```

## 2023-03-01

### Significant Changes

- colorful gem background

### Gas usage

```
·---------------------------------------|---------------------------|-------------|-----------------------------·
|         Solc version: 0.8.15          ·  Optimizer enabled: true  ·  Runs: 800  ·  Block limit: 30000000 gas  │
········································|···························|·············|······························
|  Methods                              ·               37 gwei/gas               ·       1654.10 usd/eth       │
·················|······················|·············|·············|·············|···············|··············
|  Contract      ·  Method              ·  Min        ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  burn                ·      56030  ·      99756  ·      70292  ·           70  ·       4.30  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  mint                ·      64692  ·      98892  ·      80083  ·           70  ·       4.90  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  transferFrom        ·      45842  ·      67778  ·      59008  ·          128  ·       3.61  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  burn                ·      65584  ·      99757  ·      78363  ·           33  ·       4.80  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  mint                ·      64749  ·      98949  ·      88515  ·           59  ·       5.42  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  packNode            ·      38846  ·      38906  ·      38883  ·           19  ·       2.38  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  setHistoricalInput  ·      29064  ·      29076  ·      29071  ·           23  ·       1.78  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  transferFrom        ·      50710  ·      67822  ·      55520  ·           57  ·       3.40  │
·················|······················|·············|·············|·············|···············|··············
|  Deployments                          ·                                         ·  % of limit   ·             │
········································|·············|·············|·············|···············|··············
|  Poem                                 ·          -  ·          -  ·    4466073  ·       14.9 %  ·     273.33  │
········································|·············|·············|·············|···············|··············
|  TestablePoem                         ·          -  ·          -  ·    5826323  ·       19.4 %  ·     356.58  │
·---------------------------------------|-------------|-------------|-------------|---------------|-------------·
```

## 2022-12-02

### Significant Changes

- adding hiddenLevel and jitterLevel to metadata and make them queryable externally
- removed royalties entirely

### Minor Tweaks

- token image shifting doesn't affect background

### Gas usage

```
·---------------------------------------|---------------------------|-------------|-----------------------------·
|         Solc version: 0.8.15          ·  Optimizer enabled: true  ·  Runs: 800  ·  Block limit: 30000000 gas  │
········································|···························|·············|······························
|  Methods                              ·               5 gwei/gas                ·       1285.70 usd/eth       │
·················|······················|·············|·············|·············|···············|··············
|  Contract      ·  Method              ·  Min        ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  burn                ·      56030  ·      99903  ·      70675  ·           70  ·       0.45  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  mint                ·      64704  ·      98904  ·      80338  ·           70  ·       0.52  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  transferFrom        ·      45852  ·      67778  ·      58065  ·          176  ·       0.37  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  burn                ·      56031  ·      99757  ·      78168  ·           33  ·       0.50  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  mint                ·      64749  ·      98949  ·      88225  ·           59  ·       0.57  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  packNode            ·      38891  ·      38951  ·      38928  ·           19  ·       0.25  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  setHistoricalInput  ·      29064  ·      29076  ·      29071  ·           23  ·       0.19  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  transferFrom        ·      45898  ·      67822  ·      55197  ·           60  ·       0.35  │
·················|······················|·············|·············|·············|···············|··············
|  Deployments                          ·                                         ·  % of limit   ·             │
········································|·············|·············|·············|···············|··············
|  Poem                                 ·          -  ·          -  ·    4378505  ·       14.6 %  ·      28.15  │
········································|·············|·············|·············|···············|··············
|  TestablePoem                         ·          -  ·          -  ·    5726292  ·       19.1 %  ·      36.81  │
·---------------------------------------|-------------|-------------|-------------|---------------|-------------·
```

## 2022-10-02

### New Features

- token image changes based on hiddenLevel and jitterLevel

### Significant Changes

- change royalty structure to kick in at 6 months
- remove "keepTheChange" option at mint time: too confusing

### Minor Tweaks

- switching from require to custom errors
- switch "opacityLevel" language to "hiddenLevel" language
- making MAX_NUM_JITTERS and MAX_INDEX_VAL internal instead of public
- renaming \_mintFee to mintFee since its public

## 2022-09-21

<mark>Deployed: [Rinkeby](https://rinkeby.etherscan.io/address/0xDeE90CcC0ebD4b1cf3373621946b8fee22660f47#code)</mark>

## 2022-09-21

Contracts:

- made mintFee updatable in case I mess something up at deploy time
- fixed tokenURI and SVG rendering to work with OpenSea

Scripts:

- created deploy script
- enabled Rinkelby and Goerli connections

### Gas usage

```
·---------------------------------------|---------------------------|-------------|-----------------------------·
|         Solc version: 0.8.15          ·  Optimizer enabled: true  ·  Runs: 800  ·  Block limit: 30000000 gas  │
········································|···························|·············|······························
|  Methods                              ·               3 gwei/gas                ·       1605.66 usd/eth       │
·················|······················|·············|·············|·············|···············|··············
|  Contract      ·  Method              ·  Min        ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  burn                ·      55989  ·     103307  ·      70478  ·           70  ·       0.34  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  mint                ·      64996  ·      99196  ·      80142  ·           70  ·       0.39  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  transferFrom        ·      45932  ·      67857  ·      58500  ·          145  ·       0.28  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  burn                ·      56012  ·      99734  ·      78157  ·           33  ·       0.38  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  mint                ·      65029  ·      99229  ·      88795  ·           59  ·       0.43  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  packNode            ·      38911  ·      38971  ·      38948  ·           19  ·       0.19  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  setHistoricalInput  ·      29021  ·      29033  ·      29028  ·           23  ·       0.14  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  transferFrom        ·      45987  ·      67901  ·      55533  ·           64  ·       0.27  │
·················|······················|·············|·············|·············|···············|··············
|  Deployments                          ·                                         ·  % of limit   ·             │
········································|·············|·············|·············|···············|··············
|  Poem                                 ·          -  ·          -  ·    3931553  ·       13.1 %  ·      18.94  │
········································|·············|·············|·············|···············|··············
|  TestablePoem                         ·          -  ·          -  ·    5290890  ·       17.6 %  ·      25.49  │
·---------------------------------------|-------------|-------------|-------------|---------------|-------------·
```

## 2022-08-20

Pretty significant changes.

To the contracts:

- updating node values so they all end in spaces
- when you burn the last token, update curr step the end of the path (8), instead of getting stuck at 7
- create function to get you the svg for the poem even if all the tokens are burned
- fix svg rendering to end in a closing tag
- update svg rendering with slightly better colors
- make a bunch of functions external

Scripts:

- support saving SVGs to html files
- support that happening during the simulation
- create a script file that can render almost all possible SVG outcomes

### Gas usage

```
·---------------------------------------|---------------------------|-------------|-----------------------------·
|         Solc version: 0.8.15          ·  Optimizer enabled: true  ·  Runs: 800  ·  Block limit: 30000000 gas  │
········································|···························|·············|······························
|  Methods                              ·               5 gwei/gas                ·       1585.73 usd/eth       │
·················|······················|·············|·············|·············|···············|··············
|  Contract      ·  Method              ·  Min        ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  burn                ·      62412  ·      99893  ·      70540  ·           70  ·       0.56  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  mint                ·      62896  ·      97096  ·      79264  ·           70  ·       0.63  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  transferFrom        ·      45932  ·      67857  ·      59056  ·          113  ·       0.47  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  burn                ·      65561  ·      99734  ·      78319  ·           33  ·       0.62  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  mint                ·      62929  ·      97129  ·      86810  ·           58  ·       0.69  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  packNode            ·      38911  ·      38971  ·      38948  ·           19  ·       0.31  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  setHistoricalInput  ·      29021  ·      29033  ·      29028  ·           23  ·       0.23  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  transferFrom        ·      45999  ·      67901  ·      54708  ·           60  ·       0.43  │
·················|······················|·············|·············|·············|···············|··············
|  Deployments                          ·                                         ·  % of limit   ·             │
········································|·············|·············|·············|···············|··············
|  Poem                                 ·          -  ·          -  ·    3841047  ·       12.8 %  ·      30.45  │
········································|·············|·············|·············|···············|··············
|  TestablePoem                         ·          -  ·          -  ·    5200347  ·       17.3 %  ·      41.23  │
·---------------------------------------|-------------|-------------|-------------|---------------|-------------·
```

## 2022-08-19

- Removing unnecessary comments to reduce deployment gas costs

### Gas usage

```
·---------------------------------------|---------------------------|-------------|-----------------------------·
|         Solc version: 0.8.15          ·  Optimizer enabled: true  ·  Runs: 800  ·  Block limit: 30000000 gas  │
········································|···························|·············|······························
|  Methods                              ·               5 gwei/gas                ·       1639.97 usd/eth       │
·················|······················|·············|·············|·············|···············|··············
|  Contract      ·  Method              ·  Min        ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  burn                ·      65324  ·      99711  ·      70296  ·           70  ·       0.58  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  mint                ·      62895  ·      97095  ·      78285  ·           70  ·       0.64  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  transferFrom        ·      45943  ·      67856  ·      58876  ·          153  ·       0.48  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  burn                ·      55732  ·      99454  ·      77683  ·           33  ·       0.64  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  mint                ·      62928  ·      97128  ·      86514  ·           58  ·       0.71  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  packNode            ·      38889  ·      38949  ·      38926  ·           19  ·       0.32  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  setHistoricalInput  ·      29021  ·      29033  ·      29028  ·           23  ·       0.24  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  transferFrom        ·      50721  ·      67835  ·      55730  ·           65  ·       0.46  │
·················|······················|·············|·············|·············|···············|··············
|  Deployments                          ·                                         ·  % of limit   ·             │
········································|·············|·············|·············|···············|··············
|  Poem                                 ·          -  ·          -  ·    3748395  ·       12.5 %  ·      30.74  │
········································|·············|·············|·············|···············|··············
|  TestablePoem                         ·          -  ·          -  ·    5034712  ·       16.8 %  ·      41.28  │
·---------------------------------------|-------------|-------------|-------------|---------------|-------------·
```

## 2022-08-19

- Added metadata and SVG functionality

### Gas usage

```
·---------------------------------------|---------------------------|-------------|-----------------------------·
|         Solc version: 0.8.15          ·  Optimizer enabled: true  ·  Runs: 800  ·  Block limit: 30000000 gas  │
········································|···························|·············|······························
|  Methods                              ·               9 gwei/gas                ·       1640.74 usd/eth       │
·················|······················|·············|·············|·············|···············|··············
|  Contract      ·  Method              ·  Min        ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  burn                ·      62276  ·      99757  ·      70410  ·           70  ·       1.04  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  mint                ·      62895  ·      97095  ·      78041  ·           70  ·       1.15  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  transferFrom        ·      45919  ·      67856  ·      58432  ·          159  ·       0.86  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  burn                ·      65359  ·      99532  ·      78110  ·           33  ·       1.15  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  mint                ·      62928  ·      97128  ·      86809  ·           58  ·       1.28  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  packNode            ·      38889  ·      38949  ·      38926  ·           19  ·       0.57  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  setHistoricalInput  ·      29021  ·      29033  ·      29028  ·           23  ·       0.43  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  transferFrom        ·      45933  ·      67835  ·      54688  ·           60  ·       0.81  │
·················|······················|·············|·············|·············|···············|··············
|  Deployments                          ·                                         ·  % of limit   ·             │
········································|·············|·············|·············|···············|··············
|  Poem                                 ·          -  ·          -  ·    3755984  ·       12.5 %  ·      55.46  │
········································|·············|·············|·············|···············|··············
|  TestablePoem                         ·          -  ·          -  ·    5037465  ·       16.8 %  ·      74.39  │
·---------------------------------------|-------------|-------------|-------------|---------------|-------------·
```

## 2022-08-16

- Added string evaluation and tests to ensure we were packing and upacking the string values correctly
- fixed bug in string unpacking

### Gas usage

```
·---------------------------------------|---------------------------|-------------|-----------------------------·
|         Solc version: 0.8.15          ·  Optimizer enabled: true  ·  Runs: 800  ·  Block limit: 30000000 gas  │
········································|···························|·············|······························
|  Methods                                                                                                      │
·················|······················|·············|·············|·············|···············|··············
|  Contract      ·  Method              ·  Min        ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  burn                ·      62254  ·      99553  ·      70403  ·           70  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  mint                ·      62961  ·      97161  ·      79084  ·           70  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  transferFrom        ·      45885  ·      67834  ·      58458  ·          123  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  burn                ·      62277  ·      99576  ·      78073  ·           33  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  mint                ·      62973  ·      97173  ·      86854  ·           58  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  packNode            ·      38844  ·      38904  ·      38881  ·           19  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  setHistoricalInput  ·      29085  ·      29097  ·      29092  ·           23  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  transferFrom        ·      45976  ·      67878  ·      55911  ·           59  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  Deployments                          ·                                         ·  % of limit   ·             │
········································|·············|·············|·············|···············|··············
|  Poem                                 ·          -  ·          -  ·    2824968  ·        9.4 %  ·          -  │
········································|·············|·············|·············|···············|··············
|  TestablePoem                         ·          -  ·          -  ·    4207476  ·         14 %  ·          -  │
·---------------------------------------|-------------|-------------|-------------|---------------|-------------·

```

## 2022-08-15

- Created stress test just for core Poem contract to allow more accurate gas measurements

### Gas usage

```
·---------------------------------------|---------------------------|-------------|-----------------------------·
|         Solc version: 0.8.15          ·  Optimizer enabled: true  ·  Runs: 800  ·  Block limit: 30000000 gas  │
········································|···························|·············|······························
|  Methods                                                                                                      │
·················|······················|·············|·············|·············|···············|··············
|  Contract      ·  Method              ·  Min        ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  burn                ·      62254  ·      99565  ·      70346  ·           70  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  mint                ·      62961  ·      97161  ·      78595  ·           70  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  Poem          ·  transferFrom        ·      45897  ·      67834  ·      58238  ·          160  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  burn                ·      65403  ·      99576  ·      78179  ·           33  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  mint                ·      62973  ·      97173  ·      86559  ·           58  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  packNode            ·      38866  ·      38926  ·      38903  ·           19  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  setHistoricalInput  ·      29021  ·      29033  ·      29028  ·           23  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  transferFrom        ·      45976  ·      67878  ·      54818  ·           81  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  Deployments                          ·                                         ·  % of limit   ·             │
········································|·············|·············|·············|···············|··············
|  Poem                                 ·          -  ·          -  ·    2824968  ·        9.4 %  ·          -  │
········································|·············|·············|·············|···············|··············
|  TestablePoem                         ·          -  ·          -  ·    4096325  ·       13.7 %  ·          -  │
·---------------------------------------|-------------|-------------|-------------|---------------|-------------·
```

## 2022-08-15

- Adding housekeeping functionality: mint price, royalties, etc.
- a bad attempt at updating the README

### Gas usage

```
·---------------------------------------|---------------------------|-------------|-----------------------------·
|         Solc version: 0.8.15          ·  Optimizer enabled: true  ·  Runs: 800  ·  Block limit: 30000000 gas  │
········································|···························|·············|······························
|  Methods                                                                                                      │
·················|······················|·············|·············|·············|···············|··············
|  Contract      ·  Method              ·  Min        ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  burn                ·      65403  ·      99576  ·      78164  ·           33  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  mint                ·      62973  ·      97173  ·      86854  ·           58  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  packNode            ·      38866  ·      38926  ·      38903  ·           19  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  setHistoricalInput  ·      29021  ·      29033  ·      29028  ·           23  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  transferFrom        ·      45976  ·      67878  ·      54960  ·           59  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  Deployments                          ·                                         ·  % of limit   ·             │
········································|·············|·············|·············|···············|··············
|  TestablePoem                         ·          -  ·          -  ·    4096325  ·       13.7 %  ·          -  │
·---------------------------------------|-------------|-------------|-------------|---------------|-------------·
```

## 2022-08-13

- changed Sibling storage to Jitter storage for algorithmic ease and to give a byte back to value
- changed opacity function to have similar results with decreased cyclomatic complexity
- organized Poem contract with category comments

### Gas usage

```
·---------------------------------------|---------------------------|-------------|-----------------------------·
|         Solc version: 0.8.15          ·  Optimizer enabled: true  ·  Runs: 800  ·  Block limit: 30000000 gas  │
········································|···························|·············|······························
|  Methods                                                                                                      │
·················|······················|·············|·············|·············|···············|··············
|  Contract      ·  Method              ·  Min        ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  burn                ·      65362  ·      99535  ·      78126  ·           33  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  initialize          ·          -  ·          -  ·     360567  ·            1  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  mint                ·      79514  ·      96614  ·      86590  ·           58  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  packNode            ·      38866  ·      38926  ·      38903  ·           19  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  setHistoricalInput  ·      29021  ·      29033  ·      29028  ·           23  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  transferFrom        ·      50733  ·      67835  ·      55155  ·           58  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  Deployments                          ·                                         ·  % of limit   ·             │
········································|·············|·············|·············|···············|··············
|  TestablePoem                         ·          -  ·          -  ·    3800833  ·       12.7 %  ·          -  │
·---------------------------------------|-------------|-------------|-------------|---------------|-------------·

```

## 2022-08-13

- added stress test file with new test that runs through smart contract lifecycle multiple times
- added logic to handle edge cases when left or right child was 0

### Gas usage

```
·---------------------------------------|---------------------------|-------------|-----------------------------·
|         Solc version: 0.8.15          ·  Optimizer enabled: true  ·  Runs: 800  ·  Block limit: 30000000 gas  │
········································|···························|·············|······························
|  Methods                                                                                                      │
·················|······················|·············|·············|·············|···············|··············
|  Contract      ·  Method              ·  Min        ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  burn                ·      65325  ·      99498  ·      78572  ·           33  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  mint                ·      62414  ·      96614  ·      86295  ·           58  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  packNode            ·      39467  ·      39527  ·      39504  ·           19  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  setHistoricalInput  ·      29041  ·      29053  ·      29048  ·           23  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  transferFrom        ·      45976  ·      67878  ·      54898  ·           73  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  Deployments                          ·                                         ·  % of limit   ·             │
········································|·············|·············|·············|···············|··············
|  TestablePoem                         ·          -  ·          -  ·    3295253  ·         11 %  ·          -  │
·---------------------------------------|-------------|-------------|-------------|---------------|-------------·
```

## 2022-08-09

- Removing PoemStructs implementation and reorganizing PoemPacked code to split between Poem and TestablePoem.
- This means Poem and TestablePoem no longer need to be abstract.
- Initialized Poem with the hardcoded nodes for testnet deploy. TestablePoem can always pack or unpack its own nodes.

### Gas usage

Note that if we compare these gas costs to the previous charts, hardcoding the list of nodes seems to save us some gas (roughly 7% lower deployment costs compared to calling initialize in the PoemPacked constructor).

```
·---------------------------------------|---------------------------|-------------|-----------------------------·
|         Solc version: 0.8.15          ·  Optimizer enabled: true  ·  Runs: 800  ·  Block limit: 30000000 gas  │
········································|···························|·············|······························
|  Methods                                                                                                      │
·················|······················|·············|·············|·············|···············|··············
|  Contract      ·  Method              ·  Min        ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  burn                ·      64967  ·      99129  ·      80250  ·           26  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  mint                ·      79514  ·      96614  ·      87226  ·           51  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  packNode            ·      39445  ·      39505  ·      39482  ·           19  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  setHistoricalInput  ·      29019  ·      29031  ·      29026  ·           23  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  TestablePoem  ·  transferFrom        ·      50490  ·      67592  ·      53910  ·           50  ·          -  │
·················|······················|·············|·············|·············|···············|··············
|  Deployments                          ·                                         ·  % of limit   ·             │
········································|·············|·············|·············|···············|··············
|  TestablePoem                         ·          -  ·          -  ·    3787102  ·       12.6 %  ·          -  │
·---------------------------------------|-------------|-------------|-------------|---------------|-------------·
```

## 2022-08-09

- Been modularizing code and adding tests
- It's clear that structs vs. packing only helps in a few key places: storing the node information and initializing. Because with PoemPacked we don't have to initialize, we can hardcode the node values, I think PoemPacked will save significant gas. So at this point I think we can remove the structs code. We have the gas calc below to do comparisons later if needed.

### Gas usage

```
·--------------------------------------|---------------------------|-------------|-----------------------------·
|         Solc version: 0.8.15         ·  Optimizer enabled: true  ·  Runs: 800  ·  Block limit: 30000000 gas  │
·······································|···························|·············|······························
|  Methods                                                                                                     │
················|······················|·············|·············|·············|···············|··············
|  Contract     ·  Method              ·  Min        ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │
················|······················|·············|·············|·············|···············|··············
|  PoemPacked   ·  burn                ·      93769  ·      99111  ·      97279  ·            6  ·          -  │
················|······················|·············|·············|·············|···············|··············
|  PoemPacked   ·  initialize          ·          -  ·          -  ·     871294  ·            4  ·          -  │
················|······················|·············|·············|·············|···············|··············
|  PoemPacked   ·  mint                ·      79514  ·      96614  ·      89443  ·           31  ·          -  │
················|······················|·············|·············|·············|···············|··············
|  PoemPacked   ·  packNode            ·      39650  ·      56798  ·      55875  ·           19  ·          -  │
················|······················|·············|·············|·············|···············|··············
|  PoemPacked   ·  setHistoricalInput  ·          -  ·          -  ·      29053  ·            3  ·          -  │
················|······················|·············|·············|·············|···············|··············
|  PoemPacked   ·  transferFrom        ·      50449  ·      67537  ·      58993  ·           10  ·          -  │
················|······················|·············|·············|·············|···············|··············
|  PoemStructs  ·  burn                ·      93725  ·     102676  ·     100237  ·            6  ·          -  │
················|······················|·············|·············|·············|···············|··············
|  PoemStructs  ·  initialize          ·          -  ·          -  ·    1455938  ·            4  ·          -  │
················|······················|·············|·············|·············|···············|··············
|  PoemStructs  ·  mint                ·      79491  ·      96591  ·      89420  ·           31  ·          -  │
················|······················|·············|·············|·············|···············|··············
|  PoemStructs  ·  setHistoricalInput  ·          -  ·          -  ·      29031  ·            3  ·          -  │
················|······················|·············|·············|·············|···············|··············
|  PoemStructs  ·  storeNode           ·      49736  ·      86784  ·      80623  ·           19  ·          -  │
················|······················|·············|·············|·············|···············|··············
|  PoemStructs  ·  transferFrom        ·      50471  ·      67559  ·      59015  ·           10  ·          -  │
················|······················|·············|·············|·············|···············|··············
|  Deployments                         ·                                         ·  % of limit   ·             │
·······································|·············|·············|·············|···············|··············
|  PoemPacked                          ·          -  ·          -  ·    3205799  ·       10.7 %  ·          -  │
·······································|·············|·············|·············|···············|··············
|  PoemStructs                         ·          -  ·          -  ·    3212815  ·       10.7 %  ·          -  │
·--------------------------------------|-------------|-------------|-------------|---------------|-------------·
```

## 2022-08-01

- updated PoemStructs.sol:
  - now uses one array instead of an array and a map
  - each Node fits into 1 byte, which should save on storage
- no changes to Poem.sol

### Gas usage

```
·-----------------------------|---------------------------|-------------|-----------------------------·
|    Solc version: 0.8.15     ·  Optimizer enabled: true  ·  Runs: 800  ·  Block limit: 30000000 gas  │
······························|···························|·············|······························
|  Methods                                                                                            │
················|·············|·············|·············|·············|···············|··············
|  Contract     ·  Method     ·  Min        ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │
················|·············|·············|·············|·············|···············|··············
|  Poem         ·  packNode   ·      37515  ·      56706  ·      54818  ·           19  ·          -  │
················|·············|·············|·············|·············|···············|··············
|  PoemStructs  ·  storeNode  ·      47575  ·      86561  ·      79416  ·           19  ·          -  │
················|·············|·············|·············|·············|···············|··············
|  Deployments                ·                                         ·  % of limit   ·             │
······························|·············|·············|·············|···············|··············
|  Poem                       ·          -  ·          -  ·    1684424  ·        5.6 %  ·          -  │
······························|·············|·············|·············|···············|··············
|  PoemStructs                ·          -  ·          -  ·    1566140  ·        5.2 %  ·          -  │
·-----------------------------|-------------|-------------|-------------|---------------|-------------·
```

## 2022-08-01

Created Poem and PoemStructs contracts. They have roughly the same logic, but PoemStructs uses structs to store the graph and Poem packs the struct info into a byte32.

### Gas usage

```
·-----------------------------|---------------------------|-------------|-----------------------------·
|    Solc version: 0.8.15     ·  Optimizer enabled: true  ·  Runs: 800  ·  Block limit: 30000000 gas  │
······························|···························|·············|······························
|  Methods                    ·               6 gwei/gas                ·       1680.05 usd/eth       │
················|·············|·············|·············|·············|···············|··············
|  Contract     ·  Method     ·  Min        ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │
················|·············|·············|·············|·············|···············|··············
|  Poem         ·  packNode   ·      35395  ·      54586  ·      52698  ·           19  ·       0.53  │
················|·············|·············|·············|·············|···············|··············
|  PoemStructs  ·  storeNode  ·      61155  ·     133823  ·     120302  ·           20  ·       1.21  │
················|·············|·············|·············|·············|···············|··············
|  Deployments                ·                                         ·  % of limit   ·             │
······························|·············|·············|·············|···············|··············
|  Poem                       ·          -  ·          -  ·    1568503  ·        5.2 %  ·      15.81  │
······························|·············|·············|·············|···············|··············
|  PoemStructs                ·          -  ·          -  ·    1573438  ·        5.2 %  ·      15.86  │
·-----------------------------|-------------|-------------|-------------|---------------|-------------·
```
